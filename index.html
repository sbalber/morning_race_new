<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×‘×•×§×¨ ×§×¡×•× - Morning Potions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Varela+Round&display=swap');
        
        body { 
            font-family: 'Varela Round', sans-serif;
            background-color: #fdfbf7;
            /* Soft Cotton Candy Clouds Background */
            background-image: url('https://images.unsplash.com/photo-1517502166878-35c24940a6af?q=80&w=2500&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        /* Float Animation for Animals */
        @keyframes float {
            0% { transform: translateY(0px) rotate(-5deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
            100% { transform: translateY(0px) rotate(-5deg); }
        }
        @keyframes float-reverse {
            0% { transform: translateY(0px) rotate(5deg); }
            50% { transform: translateY(-10px) rotate(-5deg); }
            100% { transform: translateY(0px) rotate(5deg); }
        }
        
        .mascot-bounce-1 { animation: float 4s ease-in-out infinite; }
        .mascot-bounce-2 { animation: float-reverse 5s ease-in-out infinite; }

        /* Liquid Animation */
        @keyframes wave {
            0% { transform: translateX(-50%) rotate(0deg); }
            50% { transform: translateX(-50%) rotate(180deg); }
            100% { transform: translateX(-50%) rotate(360deg); }
        }
        .liquid-wave { animation: wave 4s linear infinite; }

        /* Glassmorphism Classes */
        .glass-panel {
            background: rgba(255, 255, 255, 0.90); /* More opaque for readability */
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 4px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 10px 40px -10px rgba(100, 50, 200, 0.2);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.7);
            border: 2px solid rgba(255, 255, 255, 1);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #fca5a5; border-radius: 10px; }
    </style>
</head>
<body class="text-gray-800 overflow-x-hidden min-h-screen pb-10">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Configuration ---
        const TARGETS = {
            BLUE: { limit: 30 * 60, name: "×©×™×§×•×™ ×”×§×¨×—", color: "#00C2FF", bg: "bg-cyan-100", stars: 3, id: 'blue' },
            GREEN: { limit: 45 * 60, duration: 15 * 60, name: "×©×™×§×•×™ ×”×˜×‘×¢", color: "#00E676", bg: "bg-green-100", stars: 2, id: 'green' },
            PURPLE: { limit: 105 * 60, duration: 60 * 60, name: "×©×™×§×•×™ ×”×—×œ×•××•×ª", color: "#D500F9", bg: "bg-purple-100", stars: 1, id: 'purple' }
        };

        const STORAGE_KEY = 'morning_potions_data_v2';
        const STARS_FOR_GIFT = 15;

        // --- Icons (Same icons) ---
        const Icons = {
            Sun: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>,
            Shirt: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z"/></svg>,
            Sparkles: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 3v4"/><path d="M3 5h4"/><path d="M3 9h4"/></svg>,
            Utensils: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></svg>,
            Footprints: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 11 3.8 11 8c0 2.85-.67 5.5-2 8"/><path d="M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 13 7.8 13 12c0 2.85.67 5.5 2 8"/><path d="M16 17h4"/><path d="M4 16h4"/></svg>,
            Backpack: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M4 10a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2Z"/><path d="M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"/><path d="M8 21v-5a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v5"/><path d="M8 10h8"/><path d="M8 18h8"/></svg>,
            Star: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            Gift: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><polyline points="20 12 20 22 4 22 4 12"/><rect width="20" height="5" x="2" y="7"/><line x1="12" x2="12" y1="22" y2="7"/><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"/><path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"/></svg>,
            Trophy: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
            ArrowLeft: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>,
            Flask: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" {...props}><path d="M9.5 2v2.2c0 .3.2.6.4.8L11 6h2l1.1-1c.2-.2.4-.5.4-.8V2h-5zM5 21s0 1 1 1h12s1 0 1-1l-2-12H7L5 21z"/></svg>
        };

        // --- Mascot Component ---
        const Mascot = ({ type, position, delay }) => {
            const images = {
                bunny: "https://images.unsplash.com/photo-1591382386627-349b692688ff?q=80&w=400&auto=format&fit=crop", // A cuter bunny
                puppy: "https://images.unsplash.com/photo-1591160690555-5debfba289f0?auto=format&fit=crop&w=400&q=80" // Golden retriever puppy
            };
            
            return (
                <div className={`absolute z-20 ${position} ${type === 'bunny' ? 'mascot-bounce-1' : 'mascot-bounce-2'}`}>
                    <div className="w-24 h-24 md:w-36 md:h-36 rounded-full border-[6px] border-white shadow-2xl overflow-hidden bg-white transform hover:scale-110 transition-transform duration-300">
                        <img src={images[type]} alt={type} className="w-full h-full object-cover" />
                    </div>
                </div>
            );
        };

        // --- Potion Bottle Component (Unchanged logic, cleaner look) ---
        const PotionBottle = ({ type, fillPercent, isActive, isLocked, isCollected }) => {
            const config = TARGETS[type];
            const bottlePath = "M15,5 V2 c0,-0.55 -0.45,-1 -1,-1 H10 c-0.55,0 -1,0.45 -1,1 V5 c-1.66,0 -3,1.34 -3,3 v9 c0,2.21 1.79,4 4,4 h4 c2.21,0 4,-1.79 4,-4 V8 c0,-1.66 -1.34,-3 -3,-3 z";
            const liquidHeight = Math.min(100, Math.max(0, fillPercent));
            const yOffset = 21 - (liquidHeight / 100 * 13);

            return (
                <div className={`flex flex-col items-center transition-all duration-500 ${isActive ? 'scale-110 opacity-100' : 'scale-90 opacity-60'}`}>
                    <div className="relative w-24 h-28 md:w-32 md:h-40 filter drop-shadow-xl">
                        <svg viewBox="0 0 24 24" className="w-full h-full overflow-visible">
                            <defs>
                                <clipPath id={`liquidMask-${type}`}>
                                    <path d={bottlePath} />
                                </clipPath>
                            </defs>
                            <path d={bottlePath} fill="none" stroke="rgba(0,0,0,0.2)" strokeWidth="1.5" />
                            <path d={bottlePath} fill="rgba(255,255,255,0.6)" />
                            
                            <g clipPath={`url(#liquidMask-${type})`}>
                                <rect x="0" y={yOffset} width="24" height="24" fill={config.color} className={isActive ? "liquid-wave" : ""} />
                                {isActive && (
                                    <>
                                        <circle cx="10" cy={yOffset + 2} r="0.5" fill="white" className="animate-bounce" style={{animationDuration: '2s'}} />
                                        <circle cx="14" cy={yOffset + 5} r="1" fill="white" className="animate-bounce" style={{animationDuration: '1.5s', animationDelay: '0.2s'}} />
                                    </>
                                )}
                            </g>
                            <rect x="9" y="0.5" width="6" height="2" fill="#8D6E63" rx="0.5" />
                            <path d="M16 9v8c0 1-.5 1.5-1 2" stroke="white" strokeWidth="1.5" strokeLinecap="round" opacity="0.6" fill="none" />
                        </svg>
                        
                        <div className="absolute -bottom-3 -right-2 bg-white rounded-full p-1.5 shadow-md border-2 border-gray-100 flex items-center gap-1">
                             {isCollected ? (
                                <span className="text-xl">âœ…</span>
                            ) : (
                                <>
                                    <span className="font-bold text-sm text-gray-700">{config.stars}</span>
                                    <Icons.Star className="w-3.5 h-3.5 text-yellow-400 fill-yellow-400" />
                                </>
                            )}
                        </div>
                    </div>
                    <div className="mt-4 text-center">
                        <div className={`font-bold text-sm md:text-base px-3 py-1 rounded-full ${isActive ? 'bg-white/80 text-indigo-900 shadow-sm ring-2 ring-white' : 'text-gray-500'}`}>{config.name}</div>
                    </div>
                </div>
            );
        };

        function MorningApp() {
            const [view, setView] = useState('dashboard');
            // RAINBOW TASKS: Each task now has a specific colorful style
            const [tasks, setTasks] = useState([
                { id: 1, text: '×œ×§×•× ×¢× ×—×™×•×š', icon: <Icons.Sun />, completed: false, style: 'bg-yellow-100 text-yellow-700 border-yellow-200' },
                { id: 2, text: '×œ×”×ª×œ×‘×© ×™×¤×”', icon: <Icons.Shirt />, completed: false, style: 'bg-pink-100 text-pink-700 border-pink-200' },
                { id: 3, text: '×œ×¦×—×¦×— ×©×™× ×™×™×', icon: <Icons.Sparkles />, completed: false, style: 'bg-blue-100 text-blue-700 border-blue-200' },
                { id: 4, text: '×œ××›×•×œ ××¨×•×—×ª ×‘×•×§×¨', icon: <Icons.Utensils />, completed: false, style: 'bg-orange-100 text-orange-700 border-orange-200' },
                { id: 5, text: '×œ× ×¢×•×œ × ×¢×œ×™×™×', icon: <Icons.Footprints />, completed: false, style: 'bg-purple-100 text-purple-700 border-purple-200' },
                { id: 6, text: '×œ×§×—×ª ××ª ×”×ª×™×§', icon: <Icons.Backpack />, completed: false, style: 'bg-green-100 text-green-700 border-green-200' },
            ]);
            
            const [isTimerRunning, setIsTimerRunning] = useState(false);
            const [elapsedSeconds, setElapsedSeconds] = useState(0);
            const [userData, setUserData] = useState({ history: [], stars: 0, giftsUnlocked: 0 });
            const [justEarned, setJustEarned] = useState(null);

            useEffect(() => {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) setUserData(JSON.parse(saved));
            }, []);

            useEffect(() => {
                let interval = null;
                if (isTimerRunning) {
                    interval = setInterval(() => setElapsedSeconds(prev => prev + 1), 1000);
                }
                return () => clearInterval(interval);
            }, [isTimerRunning]);

            const saveData = (newData) => {
                setUserData(newData);
                localStorage.setItem(STORAGE_KEY, JSON.stringify(newData));
            };

            const getCurrentPhase = () => {
                if (elapsedSeconds <= TARGETS.BLUE.limit) return 'BLUE';
                if (elapsedSeconds <= TARGETS.GREEN.limit) return 'GREEN';
                return 'PURPLE';
            };

            const getFillPercent = (type) => {
                const currentPhase = getCurrentPhase();
                if (type === 'BLUE') {
                    if (currentPhase !== 'BLUE') return 0;
                    return (elapsedSeconds / TARGETS.BLUE.limit) * 100;
                }
                if (type === 'GREEN') {
                    if (elapsedSeconds <= TARGETS.BLUE.limit) return 0;
                    if (currentPhase === 'PURPLE') return 0;
                    return ((elapsedSeconds - TARGETS.BLUE.limit) / TARGETS.GREEN.duration) * 100;
                }
                if (type === 'PURPLE') {
                    if (elapsedSeconds <= TARGETS.GREEN.limit) return 0;
                    return Math.min(100, ((elapsedSeconds - TARGETS.GREEN.limit) / TARGETS.PURPLE.duration) * 100);
                }
                return 0;
            };

            const toggleTask = (id) => {
                setTasks(tasks.map(t => t.id === id ? { ...t, completed: !t.completed } : t));
                if (!isTimerRunning && tasks.every(t => !t.completed)) setIsTimerRunning(true);
            };

            const handleFinish = () => {
                setIsTimerRunning(false);
                const phase = getCurrentPhase();
                const earnedBottle = TARGETS[phase];
                const today = new Date().toISOString().split('T')[0];
                const result = { date: today, bottleId: earnedBottle.id, stars: earnedBottle.stars, totalTime: elapsedSeconds };
                const newData = { ...userData, history: [...userData.history, result], stars: userData.stars + earnedBottle.stars };
                saveData(newData);
                setJustEarned(earnedBottle);
                setView('victory');
                confetti({ particleCount: 200, spread: 100, origin: { y: 0.6 }, colors: [earnedBottle.color, '#FFD700', '#ffffff'] });
            };

            const handleGiftOpen = () => {
                if (userData.stars >= STARS_FOR_GIFT) {
                    const newData = { ...userData, stars: userData.stars - STARS_FOR_GIFT, giftsUnlocked: userData.giftsUnlocked + 1 };
                    saveData(newData);
                    confetti({ particleCount: 300, spread: 360 });
                    alert("ğŸ ×›×œ ×”×›×‘×•×“! ×–×›×™×ª ×‘×¤×¨×¡ ××”×§×•×¤×¡×”!");
                }
            };

            const resetDay = () => {
                setTasks(tasks.map(t => ({...t, completed: false})));
                setElapsedSeconds(0);
                setIsTimerRunning(false);
                setView('dashboard');
            };

            const renderDashboard = () => {
                const currentPhase = getCurrentPhase();
                return (
                    <div className="max-w-4xl mx-auto px-4 pt-20 pb-4 flex flex-col gap-6 relative">
                        {/* 1. ANIMAL FRIENDS sitting on top of the board */}
                        <div className="flex justify-between absolute -top-2 left-0 right-0 px-4 md:px-20 pointer-events-none z-20">
                            <Mascot type="bunny" position="transform -translate-y-1/2" />
                            <Mascot type="puppy" position="transform -translate-y-1/2" />
                        </div>

                        {/* Top Bar (Score) */}
                        <div className="flex justify-between items-center z-10 px-2">
                             <h1 className="text-xl font-bold text-white drop-shadow-md flex items-center gap-2">
                                <span>×‘×•×§×¨ ×§×¡×•×</span>
                                <span className="text-2xl">âœ¨</span>
                            </h1>
                            <button onClick={() => setView('trophyRoom')} className="bg-white/90 px-4 py-2 rounded-full border-2 border-white/50 shadow-lg flex items-center gap-2 hover:scale-105 transition">
                                <Icons.Trophy className="w-5 h-5 text-yellow-500" />
                                <span className="font-bold text-indigo-900">{userData.stars}</span>
                            </button>
                        </div>

                        {/* 2. MAIN GLASS PANEL */}
                        <div className="glass-panel rounded-[2.5rem] p-6 md:p-8 relative">
                            
                            {/* Potions Area */}
                            <div className="flex justify-center items-end gap-2 md:gap-8 mb-8 pb-4 border-b-2 border-dashed border-gray-200">
                                <PotionBottle type="BLUE" fillPercent={getFillPercent('BLUE')} isActive={currentPhase === 'BLUE'} />
                                <PotionBottle type="GREEN" fillPercent={getFillPercent('GREEN')} isActive={currentPhase === 'GREEN'} />
                                <PotionBottle type="PURPLE" fillPercent={getFillPercent('PURPLE')} isActive={currentPhase === 'PURPLE'} />
                            </div>

                            {/* Timer / Action Area */}
                            <div className="text-center mb-8">
                                {!isTimerRunning && elapsedSeconds === 0 ? (
                                    <button onClick={() => setIsTimerRunning(true)} className="bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-10 py-4 rounded-full text-xl font-bold shadow-xl hover:scale-105 transition animate-pulse border-4 border-white/20">
                                        ×‘×•××™ × ×ª×—×™×œ! â–¶ï¸
                                    </button>
                                ) : (
                                    <div className="inline-block bg-indigo-50 px-8 py-2 rounded-2xl text-3xl font-mono text-indigo-900 font-bold border-2 border-indigo-100">
                                        {new Date(elapsedSeconds * 1000).toISOString().substr(14, 5)}
                                    </div>
                                )}
                            </div>

                            {/* 3. RAINBOW TASK LIST */}
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {tasks.map(task => (
                                    <div key={task.id} onClick={() => toggleTask(task.id)} 
                                        className={`
                                            p-4 rounded-2xl cursor-pointer transition-all duration-300 flex items-center gap-4 group border-2
                                            ${task.completed 
                                                ? 'bg-gray-100 border-gray-200 grayscale opacity-60' 
                                                : `${task.style} hover:scale-[1.03] shadow-sm hover:shadow-md bg-opacity-80`
                                            }
                                        `}
                                    >
                                        <div className="bg-white p-2.5 rounded-full shadow-sm">
                                            {React.cloneElement(task.icon, { className: "w-6 h-6" })}
                                        </div>
                                        <span className="font-bold text-lg flex-grow">
                                            {task.text}
                                        </span>
                                        <div className={`w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all ${task.completed ? 'bg-green-500 border-green-500 scale-110' : 'bg-white border-white/50'}`}>
                                            {task.completed && <span className="text-white font-bold">âœ“</span>}
                                        </div>
                                    </div>
                                ))}
                            </div>

                            {/* Finish Button */}
                            <div className="mt-8">
                                <button onClick={handleFinish} disabled={!isTimerRunning}
                                    className={`
                                        w-full py-4 rounded-2xl text-2xl font-bold shadow-xl text-white transition-all transform border-b-4
                                        ${isTimerRunning 
                                            ? 'bg-gradient-to-r from-emerald-400 to-teal-500 border-teal-700 hover:translate-y-[-2px] active:translate-y-[2px] active:border-t-4 active:border-b-0' 
                                            : 'bg-gray-300 border-gray-400 cursor-not-allowed'}
                                    `}
                                >
                                    ×× ×™ ××•×›× ×”! ğŸ‰
                                </button>
                            </div>
                            
                            <div className="text-center mt-6">
                                <button onClick={resetDay} className="text-gray-400 text-sm hover:text-indigo-600 font-bold underline decoration-dashed">××™×¤×•×¡ ×™×•× ×—×“×©</button>
                            </div>
                        </div>
                    </div>
                );
            };

            const renderTrophyRoom = () => {
                return (
                    <div className="max-w-4xl mx-auto p-4 min-h-screen">
                        <div className="flex items-center gap-4 mb-6 pt-4">
                            <button onClick={() => setView('dashboard')} className="p-3 bg-white/90 rounded-full shadow hover:bg-white transition text-indigo-900">
                                <Icons.ArrowLeft />
                            </button>
                            <h1 className="text-2xl font-bold text-white drop-shadow-md">×—×“×¨ ×”×’×‘×™×¢×™× ×©×œ×š ğŸ†</h1>
                        </div>

                        <div className="glass-panel rounded-3xl p-6 shadow-lg mb-6">
                            <div className="flex justify-between items-center mb-2">
                                <span className="font-bold text-gray-700">×”×›×•×›×‘×™× ×©×œ×™</span>
                                <span className="font-bold text-xl text-yellow-500 bg-yellow-50 px-3 py-1 rounded-full border border-yellow-200">{userData.stars} / {STARS_FOR_GIFT}</span>
                            </div>
                            <div className="w-full bg-gray-100 rounded-full h-8 overflow-hidden relative border-2 border-gray-200 p-1">
                                <div className="bg-gradient-to-r from-yellow-300 to-yellow-500 h-full rounded-full transition-all duration-1000 shadow-sm" style={{width: `${Math.min(100, (userData.stars / STARS_FOR_GIFT) * 100)}%`}}></div>
                            </div>
                            
                            <div className="mt-8 flex justify-center">
                                <button onClick={handleGiftOpen} disabled={userData.stars < STARS_FOR_GIFT}
                                    className={`flex flex-col items-center gap-4 transition-all duration-300 ${userData.stars >= STARS_FOR_GIFT ? 'scale-110 cursor-pointer animate-bounce' : 'opacity-60 grayscale'}`}
                                >
                                    <div className="bg-pink-50 p-6 rounded-3xl border-4 border-pink-200 shadow-xl relative">
                                        <div className="absolute -top-3 -right-3 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full animate-pulse">×¤×¨×¡!</div>
                                        <Icons.Gift className="w-16 h-16 text-pink-500" />
                                    </div>
                                    <span className="font-bold text-pink-600 bg-white/90 px-6 py-2 rounded-full shadow-sm">
                                        {userData.stars >= STARS_FOR_GIFT ? "×œ×—×¦×™ ×›×“×™ ×œ×¤×ª×•×— ××ª ×”××ª× ×”!" : "×—×¡×¨×™× ×¢×•×“ ×›×•×›×‘×™×..."}
                                    </span>
                                </button>
                            </div>
                        </div>

                        <div className="glass-panel rounded-3xl p-6 shadow-lg">
                            <h3 className="font-bold text-gray-700 mb-4 flex items-center gap-2">
                                <Icons.Flask className="w-5 h-5 text-indigo-500"/>
                                ×”×”×™×¡×˜×•×¨×™×” ×©×œ×™
                            </h3>
                            {userData.history.length === 0 ? (
                                <div className="text-center py-10 opacity-50">
                                    <div className="text-4xl mb-2">ğŸ§ª</div>
                                    <p>×¢×“×™×™×Ÿ ×œ× ××¡×¤×ª ×©×™×§×•×™×™×. ×”×ª×—×™×œ×™ ××—×¨ ×‘×‘×•×§×¨!</p>
                                </div>
                            ) : (
                                <div className="grid gap-3">
                                    {[...userData.history].reverse().map((entry, idx) => {
                                        const bottleInfo = Object.values(TARGETS).find(t => t.id === entry.bottleId);
                                        return (
                                            <div key={idx} className="flex items-center justify-between p-4 bg-white/60 rounded-2xl border border-white hover:bg-white/80 transition shadow-sm">
                                                <div className="flex items-center gap-4">
                                                    <div className={`w-12 h-12 rounded-2xl ${bottleInfo.bg} flex items-center justify-center border-2 border-white shadow-sm`}>
                                                        <Icons.Flask className={`w-6 h-6 ${bottleInfo.id === 'blue' ? 'text-cyan-500' : bottleInfo.id === 'green' ? 'text-green-500' : 'text-purple-500'}`} />
                                                    </div>
                                                    <div>
                                                        <div className="font-bold text-gray-800 text-lg">{bottleInfo.name}</div>
                                                        <div className="text-sm text-gray-500">{entry.date}</div>
                                                    </div>
                                                </div>
                                                <div className="flex flex-col items-center">
                                                    <div className="flex text-yellow-400 drop-shadow-sm">
                                                        {[...Array(entry.stars)].map((_, i) => <Icons.Star key={i} className="w-5 h-5 fill-current" />)}
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            const renderVictory = () => {
                if (!justEarned) return null;
                return (
                    <div className="fixed inset-0 z-50 bg-indigo-900/95 backdrop-blur-xl flex flex-col items-center justify-center p-4 text-center text-white overflow-hidden">
                        <div className="absolute top-0 left-0 w-full h-full overflow-hidden z-0">
                            <div className="absolute top-10 left-10 w-32 h-32 bg-blue-500 rounded-full blur-[80px] opacity-40"></div>
                            <div className="absolute bottom-10 right-10 w-32 h-32 bg-pink-500 rounded-full blur-[80px] opacity-40"></div>
                        </div>
                        
                        <div className="z-10 animate-bounce mb-4">
                             <h2 className="text-5xl md:text-7xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-amber-400 drop-shadow-sm">×›×œ ×”×›×‘×•×“!</h2>
                        </div>
                        
                        <div className="scale-150 mb-12 mt-8 z-10 relative">
                             <div className="absolute inset-0 bg-white/20 blur-3xl rounded-full"></div>
                            <PotionBottle type={justEarned.id.toUpperCase()} fillPercent={100} isActive={true} isCollected={false} />
                        </div>
                        
                        <div className="glass-panel p-8 rounded-[2rem] mb-12 w-full max-w-xs z-10 transform hover:scale-105 transition duration-500 bg-white/10 border-white/20">
                            <div className="text-6xl font-bold mb-2 text-white drop-shadow-lg">+{justEarned.stars}</div>
                            <div className="text-indigo-200 font-bold text-xl">×›×•×›×‘×™× × ×•×¡×¤×• ×œ××•×¡×£</div>
                        </div>

                        <button onClick={() => setView('trophyRoom')} className="bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-12 py-5 rounded-full text-2xl font-bold shadow-2xl hover:scale-110 transition z-10 border-4 border-white/20">
                            ×œ×—×“×¨ ×”×’×‘×™×¢×™× ğŸ†
                        </button>
                    </div>
                );
            };

            switch (view) {
                case 'trophyRoom': return renderTrophyRoom();
                case 'victory': return renderVictory();
                default: return renderDashboard();
            }
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MorningApp />);
    </script>
</body>
</html>
